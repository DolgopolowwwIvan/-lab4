import streamlit as st
import pandas as pd
import numpy as np

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
st.set_page_config(
    page_title="–û—Ü–µ–Ω–∫–∞ —Ä–µ—à–µ–Ω–∏–π.",
    layout="wide",
    initial_sidebar_state="collapsed"
)


def main():
    # –ó–∞–≥–æ–ª–æ–≤–æ–∫
    st.title('–û—Ü–µ–Ω–∫–∞ —Ä–µ—à–µ–Ω–∏–π.')
    st.info("""
    –î–µ—Ñ–∏—Ü–∏—Ç –±—é–¥–∂–µ—Ç–∞ –≥–æ—Ä–æ–¥–∞ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 12 %. –í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ü–µ–Ω–∏—Ç—å —Ä–µ—à–µ–Ω–∏—è, –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è —Å—Ç–∞—Ç—å–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤.
    """)

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã
    options = [
        '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç—ã –≥–æ—Ä–æ–¥—Å–∫–æ–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏.',
        '–†–µ–º–æ–Ω—Ç –¥–æ—Ä–æ–≥.',
        '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç—ã —Ä–∞–±–æ—Ç–Ω–∏–∫–∞–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —É—á—Ä–µ–∂–¥–µ–Ω–∏–π.',
        '–†–µ–º–æ–Ω—Ç –ø—Ä–∏–¥–≤–æ—Ä–æ–≤—ã—Ö —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π.'
    ]

    # –°–æ–∑–¥–∞–µ–º DataFrame –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    df = pd.DataFrame({'–í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è': options})
    df.index = np.arange(1, len(df) + 1)
    st.table(df)

    # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —ç–∫—Å–ø–µ—Ä—Ç–∞
    st.markdown('---')
    st.header('–ü–æ–ø–∞—Ä–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤')

    st.success("""
    **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** 
    –î–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ 12 –±–∞–ª–ª–æ–≤ –º–µ–∂–¥—É –Ω–∏–º–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–µ–º, 
    –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ –¥—Ä—É–≥–æ–≥–æ. 

    **–ü—Ä–∏–º–µ—Ä:**
    - –ï—Å–ª–∏ –≤–∞—Ä–∏–∞–Ω—Ç A –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª—É—á—à–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞ B ‚Üí A: 9 –±–∞–ª–ª–æ–≤, B: 3 –±–∞–ª–ª–∞
    - –ï—Å–ª–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞–≤–Ω—ã ‚Üí A: 6 –±–∞–ª–ª–æ–≤, B: 6 –±–∞–ª–ª–æ–≤  
    - –ï—Å–ª–∏ –≤–∞—Ä–∏–∞–Ω—Ç A –Ω–µ–º–Ω–æ–≥–æ –ª—É—á—à–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞ B ‚Üí A: 7 –±–∞–ª–ª–æ–≤, B: 5 –±–∞–ª–ª–æ–≤

    **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã –¥–æ–ª–∂–Ω–æ —Ä–∞–≤–Ω—è—Ç—å—Å—è 12.**
    """)

    # –°–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ü–µ–Ω–æ–∫
    scores = {}

    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ä—ã –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
    for i in range(len(options)):
        for j in range(i + 1, len(options)):
            option_a = options[i]
            option_b = options[j]

            st.markdown(f'### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: **–í–∞—Ä–∏–∞–Ω—Ç {i + 1}** vs **–í–∞—Ä–∏–∞–Ω—Ç {j + 1}**')

            # –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
            col_desc1, col_desc2 = st.columns(2)
            with col_desc1:
                st.caption(f"**–í–∞—Ä–∏–∞–Ω—Ç {i + 1}:** {option_a}")
            with col_desc2:
                st.caption(f"**–í–∞—Ä–∏–∞–Ω—Ç {j + 1}:** {option_b}")

            # –°–æ–∑–¥–∞–µ–º –¥–≤–∞ —Å—Ç–æ–ª–±—Ü–∞ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –±–∞–ª–ª–æ–≤
            col1, col2 = st.columns([2, 2])

            with col1:
                st.markdown(f"**–ë–∞–ª–ª—ã –¥–ª—è –í–∞—Ä–∏–∞–Ω—Ç–∞ {i + 1}:**")
                score_a = st.slider(
                    f"–ë–∞–ª–ª—ã –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–∞ {i + 1}",
                    min_value=0,
                    max_value=12,
                    value=7,
                    key=f'{i}_{j}_a',
                    help=f"–°–∫–æ–ª—å–∫–æ –±–∞–ª–ª–æ–≤ –ø—Ä–∏—Å–≤–æ–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—É '{option_a[:50]}...'?"
                )

            with col2:
                st.markdown(f"**–ë–∞–ª–ª—ã –¥–ª—è –í–∞—Ä–∏–∞–Ω—Ç–∞ {j + 1}:**")
                score_b = st.slider(
                    f"–ë–∞–ª–ª—ã –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–∞ {j + 1}",
                    min_value=0,
                    max_value=12,
                    value=8,
                    key=f'{i}_{j}_b',
                    help=f"–°–∫–æ–ª—å–∫–æ –±–∞–ª–ª–æ–≤ –ø—Ä–∏—Å–≤–æ–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—É '{option_b[:50]}...'?"
                )


            st.markdown("**–ü—Ä–æ–≤–µ—Ä–∫–∞:**")
            total = score_a + score_b
            if total == 12:
                st.success("‚úì –°—É–º–º–∞: 12")
            else:
                st.error(f"‚úó –°—É–º–º–∞: {total}")
                st.warning("–°—É–º–º–∞ –±–∞–ª–ª–æ–≤ –¥–æ–ª–∂–Ω–∞ —Ä–∞–≤–Ω—è—Ç—å—Å—è 12!")

            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ü–µ–Ω–∫–∏
            scores[f'{i}_{j}_a'] = score_a
            scores[f'{i}_{j}_b'] = score_b

            st.markdown('---')

    # –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
    st.markdown('### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏')

    if st.button("üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —ç–∫—Å–ø–µ—Ä—Ç–Ω—É—é –æ—Ü–µ–Ω–∫—É", type="primary", use_container_width=True):
        if not name.strip():
            st.error("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –§–ò–û –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π.")
        else:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —Å—É–º–º—ã
            all_valid = True
            error_pairs = []

            for i in range(len(options)):
                for j in range(i + 1, len(options)):
                    total = scores[f'{i}_{j}_a'] + scores[f'{i}_{j}_b']
                    if total != 12:
                        all_valid = False
                        error_pairs.append(f"–í–∞—Ä–∏–∞–Ω—Ç—ã {i + 1} –∏ {j + 1} (—Å—É–º–º–∞: {total})")

            if not all_valid:
                st.error("–ù–µ –≤—Å–µ –ø–∞—Ä—ã –∏–º–µ—é—Ç —Å—É–º–º—É –±–∞–ª–ª–æ–≤ —Ä–∞–≤–Ω—É—é 12!")
                st.write("**–û—à–∏–±–∫–∏ –≤ –ø–∞—Ä–∞—Ö:**")
                for pair in error_pairs:
                    st.write(f"- {pair}")
                st.warning("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø—Ä–∞–≤—å—Ç–µ –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ –ø–∞—Ä—ã –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π.")
            else:
                # –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
                st.success(f'–ë–æ–ª—å—à–æ–µ —Å–ø–∞—Å–∏–±–æ, {name}! –í–∞—à–∞ —ç–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞.')


if __name__ == "__main__":
    main()